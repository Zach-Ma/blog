---
title: "5-数据密集型应用系统设计-数据复制"
date: 2021-11-28T10:12:05+08:00
draft: true
---

# 数据复制

> 数据复制主要挑战是处理那些**持续更改的数据**

## 常见的三种复制方法

### 主从复制

主要工作要点：

1. 写入请求首先发送给主节点，主节点首先将数据写入本地存储
2. 主节点任务完成后，将数据更改作为复制的日志或流发送给其他所有从节点，从节点进行修改
3. 客户端读取数据时，可以从主节点或从节点进行查询

#### 同步复制与异步复制

同步复制

- 主节点会阻塞所有的写操作，直到同步副部确认完成
- 优点：主从节点更新同步，万一主节点发生故障，可以从从节点访问最新数据
- 缺点：如果同步节点无法确认完成，写入就不能视为成功

异步复制

- 优点：无论从节点数据有多滞后，主节点都可以继续完成响应，系统的吞吐性能更好
- 缺点：主节点崩溃，有尚未复制到从节点的写请求都将丢失

Q: 如何在服务不中断的前提下完成新的从节点配置

1. 在某时间节点对主节点的数据副本产生一个**一致性快照**
2. 将快照拷贝至新的从节点
3. 从节点连接到主节点，请求产生快照之后所发生的数据更改日志
4. 获取日志后，从节点进行数据变更（追赶）

Q: 如何处理节点失效

从节点：追赶式恢复

主节点：节点切换

Q: 关于异步复制的复制滞后问题



⚠️从节点配置可以为全同步，半同步（至少一个主节点和一个同步从节点），全异步

### 多主节点复制

### 无主节点复制

